repos:
-   repo: local
    hooks:
    -   id: autoflake
        name: autoflake
        entry: autoflake
        language: python
        types: [python]
        files: '^(.*\.py|tests/.*|setup\.py|setup\.cfg|pyproject\.toml|requirements.*\.txt)$'
        args: [
            '--in-place',
            '--remove-all-unused-imports',
            '--remove-unused-variables',
            '--expand-star-imports',
            '--ignore-init-module-imports',
        ]

    -   id: black
        name: black
        entry: black
        language: python
        types: [python]
        files: '^(.*\.py|tests/.*|setup\.py|setup\.cfg|pyproject\.toml|requirements.*\.txt)$'

    -   id: isort
        name: isort
        entry: isort
        language: python
        types: [python]
        files: '^(.*\.py|tests/.*|setup\.py|setup\.cfg|pyproject\.toml|requirements.*\.txt)$'
        args: ['--profile', 'black']

    -   id: flake8
        name: flake8
        entry: flake8
        language: python
        types: [python]
        exclude: '^examples/.*'
        args: [
            '--ignore=E501,E221,E222,E223,E224,E303,E301,E302,E402,F401,F841,E741,W291,W293,D100,D101,W503,W504,E203',
            '--max-complexity=10',
        ]

    -   id: pytest-unit
        name: pytest (unit tests)
        entry: pytest
        language: python
        files: '^(.*\.py|tests/.*|setup\.py|setup\.cfg|pyproject\.toml|requirements.*\.txt)$'
        types: [python]
        args: [
            'tests/unit/',
            '--cov=sqlflow',
            '--cov-branch',
            '--cov-report=xml',
            '--maxfail=3',
            '-q',
            '--disable-warnings'
        ]
        pass_filenames: false

    -   id: pytest-local-integration
        name: pytest (local integration tests)
        entry: pytest
        language: python
        files: '^(.*\.py|tests/.*|setup\.py|setup\.cfg|pyproject\.toml|requirements.*\.txt)$'
        types: [python]
        args: [
            'tests/integration/',
            '-k', 'not external_services',
            '--maxfail=3',
            '-q',
            '--disable-warnings'
        ]
        pass_filenames: false

    -   id: examples-demo-scripts
        name: Run example demo scripts
        entry: ./run_all_examples.sh
        language: system
        pass_filenames: false
        files: '^examples/.*\.(sf|py|csv|yml|yaml|sh)$'
        verbose: true
