-- Basic Shopify Connection Test
-- Replace YOUR-STORE and YOUR-ACCESS-TOKEN with your actual values

SOURCE shopify_store TYPE SHOPIFY PARAMS {
    "shop_domain": "YOUR-STORE.myshopify.com",
    "access_token": "YOUR-ACCESS-TOKEN-HERE",
    "sync_mode": "full_refresh"
};

-- Test connection by loading a few orders
LOAD recent_orders FROM shopify_store OBJECT "orders" LIMIT 5;

-- Basic data exploration
CREATE TABLE order_summary AS
SELECT 
    COUNT(*) as total_orders,
    COUNT(DISTINCT customer_email) as unique_customers,
    SUM(CAST(total_price AS DECIMAL)) as total_revenue,
    MIN(created_at) as earliest_order,
    MAX(created_at) as latest_order
FROM recent_orders;

-- Export the results
EXPORT SELECT * FROM order_summary 
TO "output/connection_test_summary.csv" 
TYPE CSV OPTIONS { "header": true };

EXPORT SELECT 
    order_id,
    order_number,
    customer_email,
    total_price,
    currency,
    created_at
FROM recent_orders 
TO "output/sample_orders.csv" 
TYPE CSV OPTIONS { "header": true }; 